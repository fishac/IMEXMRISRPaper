#ifndef IMEXMRI3bCOEFFICIENTS_DEFINED__
#define IMEXMRI3bCOEFFICIENTS_DEFINED__

#include "MRICoefficients.hpp"

using namespace arma;

class IMEXMRI3bCoefficients: public MRICoefficients {
public:
	IMEXMRI3bCoefficients() {
		name = "IMEXMRI3b";
		explicit_mrigark = false;
		method_type = 0;
		
		num_gammas = 1;
		num_omegas = 1;
		num_stages = 9;
		primary_order = 3.0;
		
		mat G(num_stages,num_stages,fill::zeros);
		G(1,0) = 0.4358665215084589994160194511935568425;
		G(2,0) = -0.4358665215084589994160194511935568425;
		G(2,2) = 0.4358665215084589994160194511935568425;
		G(3,0) = 0.0414273753564414837153799230278275639;
		G(3,2) = 0.2406393638893290165766103513753940148;
		G(4,0) = -0.0414273753564414837153799230278275639;
		G(4,2) = -0.3944391461520175157006395281657292786;
		G(4,4) = 0.4358665215084589994160194511935568425;
		G(5,0) = 0.1123373143006047802633543416889605123;
		G(5,2) = 1.051807513648115027700693049638099167;
		G(5,4) = -0.8820780887029493076720571169238381009;
		G(6,0) = -0.1123373143006047802633543416889605123;
		G(6,2) = -0.1253776037178754576562056399779976346;
		G(6,4) = -0.1981516034899787614964594695265986957;
		G(6,6) = 0.4358665215084589994160194511935568425;
		gammas.push_back(G);

		mat O(num_stages,num_stages,fill::zeros);
		O(1,0) = 0.4358665215084589994160194511935568425;
		O(3,0) = -0.1750145285570467590610670000018749059;
		O(3,2) = 0.4570812678028172593530572744050964846;
		O(4,0) = 0.06042689307721552209333459437020635774;
		O(4,2) = -0.06042689307721552209333459437020635774;
		O(5,0) = 0.1195213959425454440038786034027936869;
		O(5,2) = -1.84372522668966191789853395029629765;
		O(5,4) = 2.006270569992886974186645621296725542;
		O(6,0) = -0.5466585780430528451745431084418669343;
		O(6,2) = 2.0;
		O(6,4) = -1.453341421956947154825456891558133066;
		O(7,0) = 0.105858296071879638722377459477184953;
		O(7,2) = 0.655567501140070250975288954324730635;
		O(7,4) = -1.197292318720408889113685864995472431;
		O(7,6) = 0.4358665215084589994160194511935568425;
		omegas.push_back(O);

		c = vec(num_stages,fill::zeros);
		c(0) = 0.0;
		c(1) = 0.4358665215084589994160194511935568425;
		c(2) = 0.4358665215084589994160194511935568425;
		c(3) = 0.7179332607542294997080097255967784213;
		c(4) = 0.7179332607542294997080097255967784213;
		c(5) = 1.0;
		c(6) = 1.0;
		c(7) = 1.0;
		c(8) = 1.0;
		
		num_groups = num_stages-1;
		stage_groups = {{1, 2, 3, 4, 5, 6, 7, 8}};
	}
};

#endif