#ifndef IMEXMRISRMERK5COEFFICIENTS_DEFINED__
#define IMEXMRISRMERK5COEFFICIENTS_DEFINED__

#include "MRICoefficients.hpp"

using namespace arma;

class IMEXMRISRMERK5Coefficients : public MRICoefficients {
public:
	IMEXMRISRMERK5Coefficients() {
		name = "IMEXMRISRMERK5";
		explicit_mrigark = false;
		method_type = 2;
		
		num_gammas = 1;
		num_omegas = 4;
		num_stages = 11;
		primary_order = 5.0;
		secondary_order = 4.0;
		
		mat G1(num_stages+1,num_stages,fill::zeros);
		gammas.push_back(G1);
		
		mat O1(num_stages+1,num_stages,fill::zeros);
		O1(0,0) = 0.0;
		O1(1,0) = 0.5;
		O1(2,0) = 0.5;
		O1(3,0) = 1.0/3.0;
		O1(4,0) = 0.5;
		O1(5,0) = 1.0/3.0;
		O1(6,0) = 1.0/4.0;
		O1(7,0) = 7.0/10.0;
		O1(8,0) = 0.5;
		O1(9,0) = 2.0/3.0;
		O1(10,0) = 1.0;
		omegas.push_back(O1);
		
		mat O2(num_stages+1,num_stages,fill::zeros);
		O2(2,0) = -0.5;
		O2(2,1) = 0.5;
		O2(3,0) = -2.0/9.0;
		O2(3,1) = 2.0/9.0;
		O2(4,0) = -5.0/4.0;
		O2(4,2) = -1.0;
		O2(4,3) = 9.0/4.0;
		O2(5,0) = -5.0/9.0;
		O2(5,2) = -4.0/9.0;
		O2(5,3) = 1.0;
		O2(6,0) = -5.0/16.0;
		O2(6,2) = -1.0/4.0;
		O2(6,3) = 9.0/16.0;
		O2(7,0) = -441.0/100.0;
		O2(7,4) = 49.0/25.0;
		O2(7,5) = -1323.0/100.0;
		O2(7,6) = 392.0/25.0;
		O2(8,0) = -9.0/4.0;
		O2(8,4) = 1.0;
		O2(8,5) = -27.0/4.0;
		O2(8,6) = 8.0;
		O2(9,0) = -4.0;
		O2(9,4) = 16.0/9.0;
		O2(9,5) = -12.0;
		O2(9,6) = 128.0/9.0;
		O2(10,0) = -69.0/14.0;
		O2(10,7) = 500.0/7.0;
		O2(10,8) = 28.0;
		O2(10,9) = -189.0/2.0;
		omegas.push_back(O2);
		
		mat O3(num_stages+1,num_stages,fill::zeros);
		O3(4,0) = 3.0/4.0;
		O3(4,2) = 3.0/2.0;
		O3(4,3) = -9.0/4.0;
		O3(5,0) = 2.0/9.0;
		O3(5,2) = 4.0/9.0;
		O3(5,3) = -2.0/3.0;
		O3(6,0) = 3.0/32.0;
		O3(6,2) = 3.0/16.0;
		O3(6,3) = -9.0/32.0;
		O3(7,0) = 4459.0/500.0;
		O3(7,4) = -2401.0/250.0;
		O3(7,5) = 27783.0/500.0;
		O3(7,6) = -1372.0/25.0;
		O3(8,0) = 13.0/4.0;
		O3(8,4) = -7.0/2.0;
		O3(8,5) = 81.0/4.0;
		O3(8,6) = -20.0;
		O3(9,0) = 208.0/27.0;
		O3(9,4) = -224.0/27.0;
		O3(9,5) = 48.0;
		O3(9,6) = -1280.0/27.0;
		O3(10,0) = 8.0;
		O3(10,7) = -250.0;
		O3(10,8) = -82.0;
 		O3(10,9) = 324.0;
		omegas.push_back(O3);
		
		mat O4(num_stages+1,num_stages,fill::zeros);
		O4(7,0) = -7203.0/1250.0;
		O4(7,4) = 7203.0/625.0;
		O4(7,5) = -64827.0/1250.0;
		O4(7,6) = 28812.0/625.0;
		O4(8,0) = -3.0/2.0;
		O4(8,4) = 3.0;
		O4(8,5) = -27.0/2.0;
		O4(8,6) = 12.0;
		O4(9,0) = -128.0/27.0;
		O4(9,4) = 256.0/27.0;
		O4(9,5) = -128.0/3.0;
		O4(9,6) = 1024.0/27.0;
		O4(10,0) = -30.0/7.0;
		O4(10,7) = 1500.0/7.0;
		O4(10,8) = 60.0;
 		O4(10,9) = -270.0;
		omegas.push_back(O4);

		c = vec(num_stages,fill::zeros);
		c(0) = 0.0;
		c(1) = 0.5;
		c(2) = 0.5;
		c(3) = 1.0/3.0;
		c(4) = 0.5;
		c(5) = 1.0/3.0;
		c(6) = 1.0/4.0;
		c(7) = 7.0/10.0;
		c(8) = 0.5;
		c(9) = 2.0/3.0;
		c(10) = 1.0;
		
		num_groups = 5;
		stage_groups = {{1}, {3,2}, {6,5,4}, {8,9,7}, {10}};
		//num_groups = 10;
		//stage_groups = {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}};
	}
};

#endif