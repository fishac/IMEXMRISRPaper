#ifndef ESDIRK437COEFFICIENTS_DEFINED__
#define ESDIRK437COEFFICIENTS_DEFINED__

#include "SingleRateMethodCoefficients.hpp"
#include <cmath>

using namespace arma;

class ESDIRK437Coefficients: public SingleRateMethodCoefficients {
public:
	ESDIRK437Coefficients() {
		name = "ESDIRK4(3)7L[2]SA";
		
		num_stages = 7;
		primary_order = 4.0;
		secondary_order = 3.0;
		
		A = mat(num_stages,num_stages,fill::zeros);
		A(1,0) = 1.0/8.0;
		A(1,1) = 1.0/8.0;

		A(2,0) = -39188347878.0/1513744654945.0;
		A(2,1) = -39188347878.0/1513744654945.0;
		A(2,2) = 1.0/8.0;

		A(3,0) = 1748874742213.0/5168247530883.0;
		A(3,1) = 1748874742213.0/5168247530883.0;
		A(3,2) = -1748874742213.0/5795261096931.0;
		A(3,3) = 1.0/8.0;
		
		A(4,0) = -6429340993097.0/17896796106705.0;
		A(4,1) = -6429340993097.0/17896796106705.0;
		A(4,2) = 9711656375562.0/10370074603625.0;
		A(4,3) = 1137589605079.0/3216875020685.0;
		A(4,4) = 1.0/8.0;
		
		A(5,0) = 405169606099.0/1734380148729.0;
		A(5,1) = 405169606099.0/1734380148729.0;
		A(5,2) = -264468840649.0/6105657584947.0;
		A(5,3) = 118647369377.0/6233854714037.0;
		A(5,4) = 683008737625.0/4934655825458.0;
		A(5,5) = 1.0/8.0;
		
		A(6,0) = -5649241495537.0/14093099002237.0;
		A(6,1) = -5649241495537.0/14093099002237.0;
		A(6,2) = 5718691255176.0/6089204655961.0;
		A(6,3) = 2199600963556.0/4241893152925.0;
		A(6,4) = 8860614275765.0/11425531467341.0;
		A(6,5) = -3696041814078.0/6641566663007.0;
		A(6,6) = 1.0/8.0;

		b = vec(num_stages,fill::zeros);
		b(0) = -5649241495537.0/14093099002237.0;
		b(1) = -5649241495537.0/14093099002237.0;
		b(2) = 5718691255176.0/6089204655961.0;
		b(3) = 2199600963556.0/4241893152925.0;
		b(4) = 8860614275765.0/11425531467341.0;
		b(5) = -3696041814078.0/6641566663007.0;
		b(6) = 1.0/8.0;

		d = vec(num_stages,fill::zeros);
      	d(0) = -1517409284625.0/6267517876163.0;
		d(1) = -1517409284625.0/6267517876163.0;
		d(2) = 8291371032348.0/12587291883523.0;
		d(3) = 5328310281212.0/10646448185159.0;
		d(4) = 5405006853541.0/7104492075037.0;
		d(5) = -4254786582061.0/7445269677723.0;
		d(6) = 19.0/140.0;
		
		c = A*vec(num_stages,fill::ones);
	}
};

#endif