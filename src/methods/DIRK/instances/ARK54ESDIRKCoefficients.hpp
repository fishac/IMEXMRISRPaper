#ifndef ARK54ESDIRKCOEFFICIENTS_DEFINED__
#define ARK54ESDIRKCOEFFICIENTS_DEFINED__

#include "SingleRateMethodCoefficients.hpp"

using namespace arma;

class ARK54ESDIRKCoefficients: public SingleRateMethodCoefficients {
public:
	ARK54ESDIRKCoefficients() {
		name = "ARK5(4)8L[2]SA-ESDIRK";
		
		num_stages = 8;
		primary_order = 5.0;
		secondary_order = 4.0;
		
		A = mat(num_stages,num_stages,fill::zeros);
		A(1,0) = 41.0/200.0;
		A(1,1) = 41.0/200.0;

      	A(2,0) = 41.0/400.0; 
      	A(2,1) = -567603406766.0/11931857230679.0; 
      	A(2,2) = 41.0/200.0;

      	A(3,0) = 683785636431.0/9252920307686.0; 
      	A(3,1) = 0.0;
      	A(3,2) = -110385047103.0/1367015193373.0;
      	A(3,3) = 41.0/200.0;

      	A(4,0) = 3016520224154.0/10081342136671.0; 
      	A(4,1) = 0.0; 
      	A(4,2) = 30586259806659.0/12414158314087.0; 
      	A(4,3) = -22760509404356.0/11113319521817.0; 
      	A(4,4) = 41.0/200.0;
      
      	A(5,0) = 218866479029.0/1489978393911.0; 
      	A(5,1) = 0.0; 
      	A(5,2) = 638256894668.0/5436446318841.0; 
      	A(5,3) = -1179710474555.0/5321154724896.0; 
      	A(5,4) = -60928119172.0/8023461067671.0; 
      	A(5,5) = 41.0/200.0;
      
      	A(6,0) = 1020004230633.0/5715676835656.0;
      	A(6,1) = 0.0; 
      	A(6,2) = 25762820946817.0/25263940353407.0; 
      	A(6,3) = -2161375909145.0/9755907335909.0; 
      	A(6,4) = -211217309593.0/5846859502534.0;
      	A(6,5) = -4269925059573.0/7827059040749.0; 
      	A(6,6) = 41.0/200.0;
      
      	A(7,0) = -872700587467.0/9133579230613.0;
      	A(7,1) = 0.0;
      	A(7,2) = 0.0;
      	A(7,3) = 22348218063261.0/9555858737531.0;
      	A(7,4) = -1143369518992.0/8141816002931.0;
      	A(7,5) = -39379526789629.0/19018526304540.0;
      	A(7,6) = 32727382324388.0/42900044865799.0; 
      	A(7,7) = 41.0/200.0;

		b = vec(num_stages,fill::zeros);
		b(0) = -872700587467.0/9133579230613.0;
      	b(1) = 0.0;
      	b(2) = 0.0;
      	b(3) = 22348218063261.0/9555858737531.0;
      	b(4) = -1143369518992.0/8141816002931.0;
      	b(5) = -39379526789629.0/19018526304540.0;
      	b(6) = 32727382324388.0/42900044865799.0; 
      	b(7) = 41.0/200.0;

		d = vec(num_stages,fill::zeros);
		d(0) = -975461918565/9796059967033.0; 
		d(1) = 0.0;
		d(2) = 0.0;
		d(3) = 78070527104295.0/32432590147079.0;
        d(4) = -548382580838.0/3424219808633.0;
        d(5) = -33438840321285.0/15594753105479.0;
        d(6) = 3629800801594.0/4656183773603.0;
        d(7) = 4035322873751.0/18575991585200.0;

		c = A*vec(num_stages,fill::ones);
	}
};

#endif